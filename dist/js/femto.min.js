!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Femto=e()}(this,function(){"use strict";function t(t){return"string"==typeof t?document.querySelector(t):t}function e(t){setTimeout(function(){return t()},1e3/60)}function i(t){s(t)&&t()}function s(t){return"function"==typeof t}var n=function(e,i){void 0===i&&(i={});var s=i.playTime;void 0===s&&(s=5e3);var n=i.slideMode;void 0===n&&(n="fading");var o=i.transitionTime;void 0===o&&(o=600);var d=i.autoPlay;void 0===d&&(d=!0);var l=i.plugin;void 0===l&&(l=null);var a=i.active3D;void 0===a&&(a=!1);var h=i.mode3D;void 0===h&&(h=1);var r=i.slicesCount;void 0===r&&(r=4);var c=i.events;void 0===c&&(c={}),this.el=t(e),this.settings={playTime:s,slideMode:n,transitionTime:o,autoPlay:d,plugin:l,active3D:a,slicesCount:r,mode3D:h,events:c},this.init(this.settings.plugin)};return n.create=function(t,e){return new n(t,e)},n.prototype.init=function(t){void 0===t&&(t=null),this.slides=Array.from(this.el.querySelectorAll(".femto-slide")),this.dots=Array.from(this.el.querySelectorAll(".femto-dot")),this.activeSlide=this.el.querySelector(".femto-slide.is-active"),this.activeDot=this.el.querySelector(".femto-dot.is-active"),this.loader=this.el.querySelector(".femto-loader"),this.nextButton=this.el.querySelector(".femto-next"),this.backButton=this.el.querySelector(".femto-back"),this.sliderHeight=this.el.clientHeight,this.sliderWidth=this.el.clientWidth,this.slidesCount=this.slides.length-1,this.updating=!1,this.callbacks={},this.imagesSrc=[],this.dotsInit(),this.eventsInit(),this.imagesInit(),this.slideMode(),this.autoPlay(this.settings.autoPlay),i(this.settings.events.init),t&&(this.plugin=new t(this,this.settings)),this.plugin&&s(this.plugin.init)&&this.plugin.init()},n.prototype.dotsInit=function(){var t=this;this.dots.forEach(function(e,i){e.addEventListener("click",function(){t.updateSlide(i)},!1)})},n.prototype.eventsInit=function(){var t=this;this.nextButton&&this.nextButton.addEventListener("click",this.slideNext.bind(this),!1),this.nextButton&&this.backButton.addEventListener("click",this.slideBack.bind(this),!1),this.el.addEventListener("mousedown",this.pointerDown.bind(this),!1),this.el.addEventListener("touchstart",this.pointerDown.bind(this),!1),window.addEventListener("resize",function(){t.sliderHeight=t.el.clientHeight,t.sliderWidth=t.el.clientWidth},!1)},n.prototype.imagesInit=function(){var t=this;this.slides.forEach(function(e,i){var s=e.querySelector(".femto-image")||"";s?t.imagesSrc.push(s.getAttribute("src")):t.imagesSrc.push(""),e.style.backgroundImage="url('"+t.imagesSrc[i]+"')"})},n.prototype.slideNext=function(){var t=this.slides.indexOf(this.activeSlide);return t===this.slidesCount?void this.updateSlide(0,!0):(this.updateSlide(t+1,!0),void i(this.settings.events.slideNext))},n.prototype.slideBack=function(){var t=this.slides.indexOf(this.activeSlide);return 0===t?void this.updateSlide(this.slidesCount,!1):(this.updateSlide(t-1,!1),void i(this.settings.events.slideBack))},n.prototype.updateSlide=function(t,n){var o=this;if(!(this.updating||t>this.slidesCount)){this.loading&&(this.loading=0),void 0===n&&(n=t>this.slides.indexOf(this.activeSlide)),this.updating=!0;var d=this.activeSlide,l=this.slides[t],a=n?"is-entering":"is-leaving",h=n?"is-leaving":"is-entering",r="is-active";if(this.dots[t]?(this.activeDot.classList.remove(r),this.dots[t].classList.add(r),this.activeDot=this.dots[t]):this.activeDot&&this.activeDot.classList.remove(r),i(this.settings.events.updating),this.plugin&&s(this.plugin.updateSlide))return void this.plugin.updateSlide(t);d.classList.add(h),l.classList.add(a),e(function(){d.classList.remove(r),l.classList.remove(a),l.classList.add(r)}),setTimeout(function(){d.classList.remove(h),o.activeSlide=l,o.updating=!1,i(o.settings.events.updated)},this.settings.transitionTime)}},n.prototype.play=function(){var t=this;this.playingInterval=setInterval(function(){t.loading=t.loading>1?0:t.loading+t.period,t.loader.style.width=100*t.loading+"%",t.loading||t.slideNext()},1e3/60)},n.prototype.pause=function(){clearInterval(this.playingInterval)},n.prototype.autoPlay=function(t){t&&(this.period=1e3/60/this.settings.playTime,this.loading=this.period,this.play(),this.el.addEventListener("mouseover",this.pause.bind(this),!1),this.el.addEventListener("mouseout",this.play.bind(this),!1))},n.prototype.slideMode=function(){var t=this;return"string"==typeof this.settings.slideMode?void this.slides.forEach(function(e){e.classList.add("femto-"+t.settings.slideMode)}):void this.slides.forEach(function(e,i){var s=t.settings.slideMode[i]||"fading";e.classList.add("femto-"+s)})},n.prototype.pointerDown=function(){this.sledded=!1,this.mouseX="mousedown"===event.type?event.clientX:event.touches[0].clientX,this.mouseY="mousedown"===event.type?event.clientY:event.touches[0].clientY,this.callbacks.onDrag=this.pointerDrag.bind(this),this.callbacks.onRelease=this.pointerRelease.bind(this),document.addEventListener("mousemove",this.callbacks.onDrag,!1),document.addEventListener("mouseup",this.callbacks.onRelease,!1),document.addEventListener("touchmove",this.callbacks.onDrag,!1),document.addEventListener("touchend",this.callbacks.onRelease,!1)},n.prototype.pointerDrag=function(){var t="mousemove"===event.type?event.clientX:event.touches[0].clientX,e="mousemove"===event.type?event.clientY:event.touches[0].clientY,i=t-this.mouseX,s=e-this.mouseY;1!==event.buttons&&"mousemove"===event.type||this.sledded||(i+s>50&&(this.slideNext(),this.sledded=!0),i+s<-50&&(this.slideBack(),this.sledded=!0))},n.prototype.pointerRelease=function(){document.removeEventListener("mousemove",this.callbacks.onDrag),document.removeEventListener("mouseup",this.callbacks.onRelease),document.removeEventListener("touchmove",this.callbacks.onDrag),document.removeEventListener("touchend",this.callbacks.onRelease)},n});