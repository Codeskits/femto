var t,e;t=this,e=function(){"use strict";function m(e,s){Object.keys(s).forEach(function(t){e.style[t]=s[t]})}var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t=function(){function i(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}}();return function(){function s(t,e){i(this,s),this.flow=t,this.settings=e}return t(s,[{key:"init",value:function(){var e=this;this.fragment=document.createDocumentFragment();var t=document.createElement("div");t.classList.add("animation-3d"),t.insertAdjacentHTML("afterbegin",('<div class="cube">\n       '+'<div class="cube-face"></div>'.repeat(6)+"\n     </div>").repeat(this.settings.slicesCount)),this.fragment.appendChild(t),this.flow.el.appendChild(this.fragment),this.cubes=Array.from(this.flow.el.querySelectorAll(".cube")),this.initMode(this.settings.mode3D),this.flow.slides.forEach(function(t){t.style.backgroundPosition=e.settings.isVertical?"left center":"center top"})}},{key:"initMode",value:function(t){switch(t){case 1:this.settings.isVertical=!0,this.settings.rotateAxis="X",this.settings.rotateDegree=90;break;case 2:this.settings.isVertical=!0,this.settings.rotateAxis="X",this.settings.rotateDegree=180;break;case 3:this.settings.isVertical=!1,this.settings.rotateAxis="X",this.settings.rotateDegree=90;break;case 4:this.settings.isVertical=!1,this.settings.rotateAxis="X",this.settings.rotateDegree=180;break;case 5:this.settings.isVertical=!1,this.settings.rotateAxis="Y",this.settings.rotateDegree=180;break;case"random":this.initMode((e=0,s=5,Math.floor(Math.random()*(s-e+1))+e));break;default:this.settings.isVertical=!0,this.settings.rotateAxis="X",this.settings.rotateDegree=90}var e,s}},{key:"updateSlide",value:function(e){var s=this;this.styleCubes(this.flow.imagesSrc[this.flow.activeIndex],this.flow.imagesSrc[e]);var t=this.flow.slides[this.flow.activeIndex],i=this.cubes[this.cubes.length-1],a=this.flow.el.querySelector(".animation-3d");a.style.display="block",this.flow.el.style.overflow="visible",t.classList.remove("is-active"),t.style.display="none",setTimeout(function(){s.cubes.forEach(function(t,e){setTimeout(function(){t.style.transform=s.getCubesModeTransform()},100*(e+1))})},16);i.addEventListener("transitionend",function t(){a.style.display="none",s.flow.el.style.overflow="hidden",s.flow.slides[e].style.display="block",s.flow.slides[e].classList.add("is-active"),s.flow.updating=!1,s.flow.activeIndex=e,i.removeEventListener("transitionend",t)})}},{key:"getCubesModeTransform",value:function(){var t=this.settings.isVertical?this.flow.sliderHeight/2:this.flow.sliderHeight/this.settings.slicesCount/2,e="Y"===this.settings.rotateAxis.toUpperCase()?"Y":"X";switch(this.settings.rotateDegree){case 90:return"translate3d(0, 0, -"+t+"px) rotate"+e+"(-90deg)";case 180:return"translate3d(0, 0, -"+t+"px) rotate"+e+"(180deg)";default:return"translate3d(0, 0, -"+t+"px) rotateX(-90deg)"}}},{key:"setImagesSrc",value:function(t,e,s){switch(this.settings.rotateDegree){case 90:t[0].backgroundImage="url("+e+")",t[1].backgroundImage="url("+s+")";break;case 180:t[0].backgroundImage="url("+e+")",t[2].backgroundImage="url("+s+")";break;default:t[0].backgroundImage="url("+e+")",t[1].backgroundImage="url("+s+")"}return t}},{key:"styleCubes",value:function(t,e){var s=this,i=Math.ceil(this.settings.slicesCount/2),a=this.flow.sliderHeight,r=this.flow.sliderWidth,n=this.settings.slicesCount,o=this.flow.sliderHeight/2,l=this.flow.sliderWidth/this.settings.slicesCount,d=this.flow.sliderHeight/this.settings.slicesCount,c=new Image,h=new Image;c.src=t,h.src=e;var u=this.flow.sliderWidth/c.width*c.height,g=this.flow.sliderWidth/h.width*h.height,f=this.settings.isVertical?[{transform:"translate3d(0, 0, "+o+"px) rotateY(0)",backgroundSize:u>this.flow.sliderHeight?100*n+"% auto":"auto 100%"},{transform:"translate3d(0, -50%, 0) rotateX(90deg)",backgroundSize:g>this.flow.sliderHeight?100*n+"% auto":"auto 100%"},{transform:"Y"===this.settings.rotateAxis?"translate3d(0, 0, -"+o+"px) scaleX(-1)":"translate3d(0, 0, -"+o+"px) rotateX(180deg)",backgroundSize:g>this.flow.sliderHeight?100*n+"% auto":"auto 100%"},{transform:"translate3d(0, 50%, 0) rotateX(90deg)",backgroundSize:g>this.flow.sliderHeight?100*n+"% auto":"auto 100%"},{width:a+"px",transform:"translate3d(-50%, 0, 0) rotateY(90deg)"},{width:a+"px",transform:"translate3d(calc("+l+"px - 50%), 0, 0) rotateY(90deg)"}]:[{transform:"translate3d(0, 0, "+d/2+"px) rotateY(0)",backgroundSize:u>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"},{transform:"translate3d(0, -50%, 0) rotateX(90deg)",backgroundSize:g>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"},{transform:"Y"===this.settings.rotateAxis?"translate3d(0, 0, -"+d/2+"px) scaleX(-1)":"translate3d(0, 0, -"+d/2+"px) rotateX(180deg)",backgroundSize:g>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"},{transform:"translate3d(0, 50%, 0) rotateX(90deg)",backgroundSize:g>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"},{width:d+"px",transform:"translate3d(-50%, 0, 0) rotateY(90deg)",backgroundSize:g>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"},{width:d+"px",transform:"translate3d(calc("+r+"px - 50%), 0, 0) rotateY(90deg)",backgroundSize:g>this.flow.sliderHeight?"100% auto":"auto "+100*n+"%"}];f=this.setImagesSrc(f,t,e),this.cubes.forEach(function(t,e){m(t,s.settings.isVertical?{top:0,left:100/n*e+"%",width:100/n+"%",height:"100%",zIndex:e<i?10*(e+1):10*(n-e),transform:"translate3d(0, 0, -"+o+"px) rotateX(0deg) rotateY(0deg)",backgroundPosition:e*-l+"px center"}:{top:100/n*e+"%",left:0,width:"100%",height:100/n+"%",zIndex:e<i?10*(e+1):10*(n-e),transform:"translate3d(0, 0, -"+d/2+"px) rotateX(0deg) rotateY(0deg)",backgroundPosition:" center "+e*-d+"px"}),Array.from(t.querySelectorAll(".cube-face")).forEach(function(t,e){m(t,f[e])})})}}]),s}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Cube3D=e();