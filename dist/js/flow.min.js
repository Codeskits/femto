var e,t;e=this,t=function(){"use strict";function d(e){c(e)&&e()}function c(e){return"function"==typeof e}var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e=function(){function s(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}}(),t=function(){function s(e,t){var i;n(this,s),this.el="string"==typeof(i=e)?document.querySelector(i):i,this.settings=Object.assign({},s.defaults,t),this.init(this.settings.plugin)}return e(s,[{key:"init",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.slides=Array.from(this.el.querySelectorAll(".flow-slide")),this.activeIndex=this.slides.indexOf(this.el.querySelector(".flow-slide.is-active")),this.nextButton=this.el.querySelector(".flow-next"),this.backButton=this.el.querySelector(".flow-back"),this.sliderHeight=this.el.clientHeight,this.sliderWidth=this.el.clientWidth,this.slidesCount=this.slides.length-1,this.updating=!1,this.callbacks={},this.imagesSrc=[],this.indicators=[],this.indicatorsInit(),this.eventsInit(),this.imagesInit(),this.slideMode(),this.settings.autoPlay&&(this.loader=document.createElement("div"),this.loader.classList.add("flow-loader"),this.el.appendChild(this.loader),this.autoPlay()),d(this.settings.events.init),e&&(this.plugin=new e(this,this.settings)),this.plugin&&c(this.plugin.init)&&this.plugin.init()}},{key:"indicatorsInit",value:function(){var n=this,a=document.createElement("ul");a.classList.add("flow-dots"),this.slides.forEach(function(e,t){var i=document.createElement("li"),s=n.indicators[t]=document.createElement("a");s.classList.add("flow-dot"),s.classList.toggle("is-active",t===n.activeIndex),s.addEventListener("click",function(){return n.updateSlide(t)}),i.appendChild(s),a.appendChild(i)}),this.el.appendChild(a)}},{key:"eventsInit",value:function(){var t=this;this.nextButton&&this.nextButton.addEventListener("click",this.slideNext.bind(this),!1),this.nextButton&&this.backButton.addEventListener("click",this.slideBack.bind(this),!1),this.el.addEventListener("mousedown",function(e){return t.pointerDown(e)},!1),this.el.addEventListener("touchstart",function(e){return t.pointerDown(e)},!1),window.addEventListener("resize",function(){t.sliderHeight=t.el.clientHeight,t.sliderWidth=t.el.clientWidth},!1)}},{key:"imagesInit",value:function(){var s=this;this.slides.forEach(function(e,t){var i=e.querySelector(".flow-image");i?s.imagesSrc.push(i.getAttribute("src")):s.imagesSrc.push(""),e.style.backgroundImage="url('"+s.imagesSrc[t]+"')"})}},{key:"slideNext",value:function(){this.activeIndex!==this.slidesCount?(this.updateSlide(this.activeIndex+1,!0),d(this.settings.events.slideNext)):this.updateSlide(0,!0)}},{key:"slideBack",value:function(){0!==this.activeIndex?(this.updateSlide(this.activeIndex-1,!1),d(this.settings.events.slideBack)):this.updateSlide(this.slidesCount,!1)}},{key:"updateSlide",value:function(e,t){var i=this;if(!(this.updating||e>this.slidesCount||e===this.activeIndex))if(t=t||e>this.activeIndex,this.updating=!0,this.updateIndicators(e),d(this.settings.events.updating),this.plugin&&c(this.plugin.updateSlide))this.plugin.updateSlide(e);else{var s=this.slides[this.activeIndex],n=this.slides[e],a=t?"is-entering":"is-leaving",l=t?"is-leaving":"is-entering",o="is-active";setTimeout(function(){i.activeIndex=e},this.settings.transitionTime),s.classList.add(l),n.classList.add(a),setTimeout(function(){s.classList.remove(o),n.classList.remove(a),n.classList.add(o),i.updating=!1},16),setTimeout(function(){s.classList.remove(l),d(i.settings.events.updated)},this.settings.transitionTime)}}},{key:"updateIndicators",value:function(e){if(this.indicators){var t="is-active";this.indicators[this.activeIndex].classList.remove(t),this.indicators[e].classList.add(t)}}},{key:"play",value:function(){var e=this;this.period=16/this.settings.playTime,this.playingInterval=setInterval(function(){1<=e.loading&&(e.loading=0,e.loader.style.transform="scaleX(0)",e.slideNext()),window.requestAnimationFrame(function(){e.loading+=e.period,e.loader.style.transform="scaleX("+e.loading+")"})},16)}},{key:"pause",value:function(){clearInterval(this.playingInterval)}},{key:"autoPlay",value:function(){this.loading=0,this.play(),this.el.addEventListener("mouseover",this.pause.bind(this),!1),this.el.addEventListener("mouseout",this.play.bind(this),!1)}},{key:"slideMode",value:function(){var s=this;"string"!=typeof this.settings.slideMode?this.slides.forEach(function(e,t){var i=s.settings.slideMode[t]||"fading";e.classList.add("flow-"+i)}):this.slides.forEach(function(e){e.classList.add("flow-"+s.settings.slideMode)})}},{key:"pointerDown",value:function(e){this.sledded=!1,this.mouseX="mousedown"===e.type?e.clientX:e.touches[0].clientX,this.mouseY="mousedown"===e.type?e.clientY:e.touches[0].clientY,this.callbacks.onDrag=this.pointerDrag.bind(this),this.callbacks.onRelease=this.pointerRelease.bind(this),document.addEventListener("mousemove",this.callbacks.onDrag,!1),document.addEventListener("mouseup",this.callbacks.onRelease,!1),document.addEventListener("touchmove",this.callbacks.onDrag,!1),document.addEventListener("touchend",this.callbacks.onRelease,!1)}},{key:"pointerDrag",value:function(){var e="mousemove"===event.type?event.clientX:event.touches[0].clientX,t="mousemove"===event.type?event.clientY:event.touches[0].clientY,i=e-this.mouseX,s=t-this.mouseY;1!==event.buttons&&"mousemove"===event.type||this.sledded||(50<i+s&&(this.slideNext(),this.sledded=!0),i+s<-50&&(this.slideBack(),this.sledded=!0))}},{key:"pointerRelease",value:function(){document.removeEventListener("mousemove",this.callbacks.onDrag),document.removeEventListener("mouseup",this.callbacks.onRelease),document.removeEventListener("touchmove",this.callbacks.onDrag),document.removeEventListener("touchend",this.callbacks.onRelease)}}],[{key:"create",value:function(e,t){return new s(e,t)}}]),s}();return t.defaults={playTime:5e3,slideMode:"fading",transitionTime:600,autoPlay:!0,plugin:null,active3D:!1,mode3D:1,slicesCount:4,events:{}},t},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Flow=t();